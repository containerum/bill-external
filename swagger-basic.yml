swagger: "2.0"
info:
  version: "1.0"
  title: Billing Manager API.
  license:
    name: Apache License, Vesion 2.0
  description: The Billing Manager API project is used for actions with tariffs and subscriptions.
consumes:
  - application/json
produces:
  - application/json
definitions:
  ResourceType:
    type: string
    enum:
      - namespace
      - volume
responses:
  error:
    description: cherry error
    schema:
      $ref: 'vendor/github.com/containerum/cherry/swagger.json#/definitions/Err'
paths:
  /isp/subscription:
    post:
      summary: Subscribe user to tariff whenever he adds a namespace or volume.
      operationId: SubscribeTariff
      tags:
        - Subscription
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/SubscribeTariffRequest'
      responses:
        '202':
          description: successfully subscribed
        default:
          $ref: '#/responses/error'
    delete:
      summary: Unsubscribe user from every tariff.
      operationId: MassiveUnsubscribeTariff
      tags:
        - Subscription
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/MassiveUnsubscribeTariffRequest'
      responses:
        '202':
          description: successfully unsubscribed
        default:
          $ref: '#/responses/error'
  /isp/subscription/{resource_id}:
    put:
      summary: Change tariff in subscription
      operationId: ChangeTariffRequest
      tags:
        - Subscription
      parameters:
        - name: resource_id
          in: path
          type: string
          required: true
          description: uuid
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ChangeTariffRequest'
      responses:
        '202':
          description: successfully changed
        default:
          $ref: '#/responses/error'
    delete:
      summary: Unsubscribe user from tariff
      operationId: UnsubscribeTariff
      tags:
        - Subscription
      parameters:
        - name: resource_id
          in: path
          type: string
          required: true
          description: uuid
      responses:
        '202':
          description: successfully unsubscribed
        default:
          $ref: '#/responses/error'
  /tariffs/namespace/{tariff_id}:
    get:
      summary: Get namespace tariff by ID.
      operationId: GetNamespaceTariff
      tags:
        - Tariffs
      parameters:
        - name: tariff_id
          in: path
          required: true
          type: string
          format: uuid
      responses:
        '200':
          description: namespace tariff
          schema:
            $ref: '#/definitions/NamespaceTariff'
        default:
          $ref: '#/responses/error'
  /tariffs/volume/{tariff_id}:
    get:
      summary: Get volume tariff by ID.
      operationId: GetVolumeTariff
      tags:
        - Tariffs
      parameters:
        - name: tariff_id
          in: path
          required: true
          type: string
          format: uuid
      responses:
        '200':
          description: volume tariff
          schema:
            $ref: '#/definitions/VolumeTariff'
        default:
          $ref: '#/responses/error'